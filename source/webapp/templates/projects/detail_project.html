{% extends 'tasks/../base.html' %}

{% block title %}
    	<title>Детальный просмотр</title>
    {% endblock %}

{% block navbar %}
    {% if user.is_authenticated %}
    <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{% url "webapp:create_project" %}">Создать</a>
        </li>
    <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{% url "webapp:update_project" project.pk %}">Редактировать</a>
        </li>
    <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="{% url 'webapp:delete_project' project.pk %}">Удалить</a>
        </li>

    {% endif %}
          {% endblock %}

{% block content %}

   <div class="card mt-3">
  <div class="card-header">
    <strong>{{ project.title }}</strong>
  </div>
  <div class="card-body">
    <figure>
      <blockquote class="blockquote">
        <p>{{  project.description }}</p>
      </blockquote>
        <figcaption class="blockquote-footer">
       Начало:  <cite title="Добавлено">{{ project.start_date }}</cite>
      </figcaption>
        <figcaption class="blockquote-footer">
       Финиш: <cite title="Обновлено">{{ project.end_date }}</cite>
      </figcaption>


{% include 'partial/simple_search.html' with form=search_form %}

<form method="post" action="{% url 'webapp:delete_all_tasks' %}">
  {% csrf_token %}
  <div class="row mt-4">
    {% for task in tasks %}
      <div class="col-12 col-md-4 col-lg-3 mb-3">
        <div class="card border-primary mb-3">
          <div class="card-body">
            <div class="form-check mb-2">
              <input class="form-check-input" type="checkbox" name="task_ids" value="{{ task.id }}" id="task-{{ task.id }}">
              <label class="form-check-label" for="task-{{ task.id }}">
                <strong>{{ task.summary }}</strong>
              </label>
                <br>
            </div>
          <div>
               <h6 class="card-subtitle mb-2 text-body-secondary">{{ task.status.name }}</h6>
              <br>
          <figcaption class="blockquote-footer">
       Автор: <cite title="Автор">{{ task.author }}</cite>
      </figcaption>
          </div>
               <div class="card-footer bg-transparent">
                   <a href="{% url 'webapp:detail_task' task.pk %}" title="Подробности"><i class="bi bi-info-square"></i></a>
                   {% if user.is_authenticated %}
                       {% if perms.webapp.change_task and user == task.author %}
            <a href="{% url 'webapp:update_task' task.pk %}" title="Редактировать"> <i class="bi bi-pencil-square"></i></a>
                         {% endif %}
                        {% if perms.webapp.delete_task and user == task.author %}
                           <a href="{% url 'webapp:delete_task' task.pk %}" title="Удалить"><i class="bi bi-x-square-fill"></i></a>
                   {% endif %}
                       {% endif %}

               </div>
          </div>
        </div>
      </div>
    {% empty %}
      <p>Задачи не найдены</p>
    {% endfor %}
  </div>
    <div class="mt-3">
        {% if user.is_authenticated %}
             {% if perms.webapp.delete_task and user == task.author %}
    <button type="submit" class="btn btn-danger">Удалить выбранные задачи</button>
        {% endif %}
             {% endif %}
  </div>
</form>
    <br>
{% if is_paginated %}
    {% include 'partial/pagination.html' %}
    {% endif %}


    </figure>
  </div>
</div>
{% endblock %}